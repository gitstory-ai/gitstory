# TASK-0001.1.3.2: Implement 6 Placeholder Commands

**Parent Story**: [STORY-0001.1.3](README.md)
**Status**: ✅ Complete
**Estimated Hours**: 4
**Actual Hours**: 4

## Objective

Implement 6 CLI commands with placeholder functionality, consistent argument patterns, and proper error handling optimized for Claude invocation.

## Implementation Checklist

### Phase 1: Write Unit Tests First (TDD - RED)

- [ ] Create test file structure (`tests/unit/cli/test_commands.py`)
  - Import: `from typer.testing import CliRunner`, `from gitstory.cli import app`
  - Fixture: `@pytest.fixture def runner() -> CliRunner: return CliRunner()`
- [ ] Write tests for plan command
  - Assert: `result.exit_code == 0`
  - Assert: `"Planning STORY-0001.2.4" in result.stdout`
  - Assert: `"Coming in EPIC-0001.2" in result.stdout`
- [ ] Write tests for review command
  - Assert: `result.exit_code == 0`
  - Assert: `"Reviewing EPIC-0001.3" in result.stdout`
  - Assert: `"Coming in EPIC-0001.2" in result.stdout`
- [ ] Write tests for execute command
  - Assert: `result.exit_code == 0`
  - Assert: `"Executing TASK-0001.2.4.3" in result.stdout`
- [ ] Write tests for validate command
  - Assert: `result.exit_code == 0`
  - Assert: `"Validating workflow" in result.stdout`
- [ ] Write tests for test-plugin command
  - Assert: `result.exit_code == 0`
  - Assert: `"Testing plugin all_children_done" in result.stdout`
- [ ] Write tests for init command
  - Assert: `result.exit_code == 0`
  - Assert: `"Initializing GitStory" in result.stdout`
- [ ] Run tests: `pytest tests/unit/cli/test_commands.py -v` - all fail ✓

### Phase 2: Implement Commands (GREEN)

- [ ] Create `src/gitstory/cli/plan.py` with @app.command() decorator
- [ ] Create `src/gitstory/cli/review.py` with @app.command() decorator
- [ ] Create `src/gitstory/cli/execute.py` with @app.command() decorator
- [ ] Create `src/gitstory/cli/validate.py` with @app.command() decorator
- [ ] Create `src/gitstory/cli/test_plugin.py` with @app.command() decorator
- [ ] Create `src/gitstory/cli/init.py` with @app.command() decorator
- [ ] Run tests - all pass ✓

### Phase 3: Register Commands

- [ ] Import all commands in `src/gitstory/cli/__init__.py`
- [ ] Verify commands appear in `gitstory --help` output
- [ ] Test each command executes without errors

### Verification

- [ ] All unit tests pass: `pytest tests/unit/cli/test_commands.py -v`
- [ ] All 6 commands listed in `gitstory --help`
  - Command: `uv run python -m gitstory --help | grep -E "(plan|review|execute|validate|test-plugin|init)"`
  - Verify: Each command name appears in help output
- [ ] Each command shows help: `gitstory plan --help` works
  - Command: `uv run python -m gitstory plan --help | grep -q "Plan tickets" && echo "PASS"`
  - Verify: Help text displays for all 6 commands
- [ ] Commands accept ticket ID argument: `gitstory plan STORY-0001.2.4` prints placeholder
  - Command: `uv run python -m gitstory plan STORY-0001.2.4`
  - Verify: Exit code 0, output contains "Planning STORY-0001.2.4" and "Coming in EPIC-0001.2"
- [ ] Placeholder message format consistent
  - All commands output: info message + warning "Coming in EPIC-X.Y" message
  - No errors or exceptions thrown
- [ ] Exit codes correct
  - Placeholder commands: exit code 0 (always succeed)
  - Missing argument: exit code 2 (Typer default)
- [ ] Code coverage >90% for command files
  - Command: `pytest tests/unit/cli/test_commands.py --cov=src/gitstory/cli --cov-report=term-missing`
  - Verify: Coverage >90% for plan.py, review.py, execute.py, validate.py, test_plugin.py, init.py
  - Baseline: Currently 0% for these new files (will reach >90% after tests)

## Files to Create/Modify

- CREATE: `src/gitstory/cli/plan.py` (~40 lines, plan command)
- CREATE: `src/gitstory/cli/review.py` (~40 lines, review command)
- CREATE: `src/gitstory/cli/execute.py` (~40 lines, execute command)
- CREATE: `src/gitstory/cli/validate.py` (~40 lines, validate command)
- CREATE: `src/gitstory/cli/test_plugin.py` (~40 lines, test-plugin command)
- CREATE: `src/gitstory/cli/init.py` (~40 lines, init command)
- MODIFY: `src/gitstory/cli/__init__.py` (import all commands)
- CREATE: `tests/unit/cli/test_commands.py` (~120 lines, tests for all commands)

## Command Signatures (Consistent Pattern)

### 1. plan command
```python
@app.command()
def plan(
    ticket_id: str = typer.Argument(..., help="Ticket ID to plan (e.g., STORY-0001.2.4)"),
    verbose: bool = typer.Option(False, "--verbose", "-v", help="Show detailed output"),
) -> None:
    """Plan tickets: create epics, stories, or tasks with interview process."""
    output.info(f"Planning {ticket_id}...")
    output.warning("Coming in EPIC-0001.2: Workflow engine & planning logic")
```

### 2. review command
```python
@app.command()
def review(
    ticket_id: str = typer.Argument(..., help="Ticket ID to review (e.g., EPIC-0001.3)"),
    focus: str = typer.Option(None, "--focus", help="Specific concern to focus on"),
) -> None:
    """Review ticket quality, detect issues, propose fixes."""
    output.info(f"Reviewing {ticket_id}...")
    output.warning("Coming in EPIC-0001.2: Quality checker & validation logic")
```

### 3. execute command
```python
@app.command()
def execute(
    ticket_id: str = typer.Argument(..., help="Ticket ID to execute (e.g., TASK-0001.2.4.3)"),
    dry_run: bool = typer.Option(False, "--dry-run", help="Show actions without executing"),
) -> None:
    """Execute ticket workflows: state transitions, git operations, validations."""
    output.info(f"Executing {ticket_id}...")
    output.warning("Coming in EPIC-0001.2: Workflow execution engine")
```

### 4. validate command
```python
@app.command()
def validate(
    target: str = typer.Argument("workflow", help="What to validate: workflow, ticket, or config"),
    path: str = typer.Option(".gitstory/workflow.yaml", "--path", help="Path to file"),
) -> None:
    """Validate workflow.yaml, ticket structure, or config files."""
    output.info(f"Validating {target} at {path}...")
    output.warning("Coming in EPIC-0001.2: Validation engine")
```

### 5. test-plugin command
```python
@app.command(name="test-plugin")
def test_plugin(
    plugin_name: str = typer.Argument(..., help="Plugin to test (e.g., all_children_done)"),
    ticket_id: str = typer.Option(None, "--ticket", help="Ticket ID for plugin context"),
    verbose: bool = typer.Option(False, "--verbose", "-v", help="Show detailed output"),
) -> None:
    """Test individual workflow plugins in isolation."""
    output.info(f"Testing plugin {plugin_name}...")
    output.warning("Coming in EPIC-0001.3: Plugin testing framework")
```

### 6. init command
```python
@app.command()
def init(
    force: bool = typer.Option(False, "--force", help="Overwrite existing .gitstory/"),
) -> None:
    """Initialize GitStory in repository: copy workflow.yaml, create directories."""
    output.info("Initializing GitStory...")
    output.warning("Coming in EPIC-0001.2: Initialization logic")
```

## Consistent Patterns

### Argument Structure
- First positional argument: Primary entity (ticket_id, plugin_name, target)
- Optional flags: --verbose, --dry-run, --focus, --force
- Help text: Clear, concise, includes examples

### Output Structure (Placeholder)
1. Info message: "Processing {entity}..."
2. Warning message: "Coming in EPIC-X.Y: [specific implementation]"
3. Exit code 0 (success placeholder)

### Error Handling

**Ticket ID Validation:**
- Valid formats: `{INIT|EPIC|STORY|TASK}-NNNN(.N)*` (case-sensitive)
  - Examples: `STORY-0001.2.4`, `EPIC-0001.3`, `TASK-0001.2.4.3`, `INIT-0001`
  - Invalid: `story-0001` (lowercase), `STORY-abc` (non-numeric), `INVALID-0001` (unknown prefix)
- No validation in placeholder commands (accept any string)
- Future validation will use regex: `^(INIT|EPIC|STORY|TASK)-\d+(\.\d+)*$`

**Error Responses:**
- Missing required argument → Typer shows usage (handled automatically, exit code 2)
- Unknown option → Typer shows error (handled automatically, exit code 2)
- Placeholder commands always return exit code 0 (no validation yet)

## Pattern Reuse

- `typer.Argument()` - Positional arguments with validation
- `typer.Option()` - Optional flags with defaults
- `OutputFormatter` - From TASK-0001.1.3.1 for consistent messages

## Dependencies

- TASK-0001.1.3.1 complete (OutputFormatter available)
- pyproject.toml entry point: `gitstory = "gitstory.cli:app"`

## Success Criteria

- ✅ All 6 commands implemented with consistent signatures
- ✅ Commands accept correct arguments and options
- ✅ Placeholder messages show future epic where logic will be implemented
- ✅ Help text clear and includes examples
- ✅ Exit codes correct (0 for success placeholder)
- ✅ All commands callable: `gitstory plan`, `gitstory review`, etc.
- ✅ Code coverage >90%
