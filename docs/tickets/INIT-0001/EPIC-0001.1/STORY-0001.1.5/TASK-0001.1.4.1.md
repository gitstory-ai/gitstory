# TASK-0001.1.4.1: Write BDD scenarios for command configuration

**Parent Story**: [STORY-0001.1.4](README.md)
**Status**: ðŸ”µ Not Started
**Estimated Hours**: 3
**Actual Hours**: -

## Objective

Write complete BDD test suite with all 7 scenarios from the story README in Gherkin format and stubbed step definitions. This task defines WHAT the command configuration system should do before implementing HOW it does it.

## BDD Progress

**Before this task**: 0/7 scenarios (none exist)
**After this task**: 0/7 scenarios passing (all stubbed, all failing)

**Scenarios for this task:**

- Scenario 1: Command configuration examples available in skills/gitstory/commands/
- Scenario 2: Command configuration includes name, description, triggers, steps
- Scenario 3: Command triggers support 3 pattern types
- Scenario 4: Command variables support substitution patterns
- Scenario 5: Command configuration lookup priority: project â†’ user â†’ skill
- Scenario 6: Commands integrate with templates
- Scenario 7: Command configuration syntax validates with Python YAML parser

## Implementation Checklist

### Create Feature File

- [ ] Create `tests/e2e/features/command_configuration.feature`
- [ ] Write Scenario 1: Configuration examples available
  - [ ] Given the GitStory skill directory structure
  - [ ] When I check skills/gitstory/commands/
  - [ ] Then plan.yaml, review.yaml, install.yaml exist
- [ ] Write Scenario 2: Config structure (name, description, triggers, steps)
  - [ ] Given skills/gitstory/commands/plan.yaml
  - [ ] When I parse the YAML structure
  - [ ] Then it includes name, description, triggers array, steps array
- [ ] Write Scenario 3: Trigger types (pattern, keyword, ticket_id)
  - [ ] Given command configurations with triggers
  - [ ] When evaluating trigger matching
  - [ ] Then pattern/keyword/ticket_id triggers all work
- [ ] Write Scenario 4: Variable substitution ({ticket_id}, {branch_name}, {user_input})
  - [ ] Given command with variables
  - [ ] When executing command steps
  - [ ] Then variables substitute correctly
- [ ] Write Scenario 5: Lookup priority (project â†’ user â†’ skill)
  - [ ] Given overrides at all 3 levels
  - [ ] When loading command
  - [ ] Then project checked first, user second, skill fallback
- [ ] Write Scenario 6: Template integration
  - [ ] Given plan.yaml and story.md template
  - [ ] When plan command executes
  - [ ] Then it references template fields
- [ ] Write Scenario 7: YAML validation
  - [ ] Given all command configs
  - [ ] When parsing with yaml.safe_load()
  - [ ] Then no parsing errors

### Create Step Definition Stubs

- [ ] Create `tests/e2e/steps/test_command_configuration.py`
- [ ] Stub all step definitions (each raises NotImplementedError)
- [ ] Ensure clear step names matching Gherkin exactly
- [ ] Group steps by scenario for clarity

### Verification

- [ ] Run pytest - all 7 scenarios fail with NotImplementedError âœ“
- [ ] Scenarios are concrete and executable (no vague terms)
- [ ] Step definitions follow pytest-bdd decorator conventions

## Files to Create/Modify

- CREATE: `tests/e2e/features/command_configuration.feature` (~150 lines, 7 scenarios)
- CREATE: `tests/e2e/steps/test_command_configuration.py` (~100 lines, stubbed steps)

## Pattern Reuse

- `pytest-bdd feature file organization` (tests/e2e/features/*.feature) - Separate Gherkin scenarios from step implementations

## Dependencies

- Feature file format follows pytest-bdd Gherkin syntax
- Step definitions use pytest-bdd decorators (@given, @when, @then)
- Scenarios match story README exactly (copy verbatim)
