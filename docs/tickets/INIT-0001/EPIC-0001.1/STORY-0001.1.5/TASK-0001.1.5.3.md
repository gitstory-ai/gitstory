# TASK-0001.1.5.3: Write core documentation guides

**Parent Story**: [STORY-0001.1.5](README.md)
**Status**: ðŸ”µ Not Started
**Estimated Hours**: 8
**Actual Hours**: -

## Objective

Write 3 comprehensive documentation guides: workflow-schema.md (500+ words), template-authoring.md (400+ words with 3+ examples), and command-authoring.md (400+ words with 3+ examples). Core content creation task.

## BDD Progress

**Before this task**: 2/8 scenarios passing
**After this task**: 6/8 scenarios passing

**Scenarios for this task:**

- Scenario 2: Workflow schema documentation explains ticket hierarchy (FULL)
- Scenario 3: Template authoring guide enables custom template creation (FULL)
- Scenario 4: Command authoring guide enables custom command creation (FULL)
- Scenario 8: Documentation examples validate syntactically (PARTIAL - template + command examples only)

## Implementation Checklist

### Write workflow-schema.md

- [ ] Create `skills/gitstory/references/workflow-schema.md`:
  ```markdown
  # GitStory Workflow Schema

  **GitStory uses a 4-tier ticket hierarchy for organizing development work.**

  ## Ticket Hierarchy

  ```
  Initiative (INIT-NNNN)           # Strategic goal (quarters/years)
  â””â”€â”€ Epic (EPIC-NNNN.N)          # Feature set (weeks/months)
      â””â”€â”€ Story (STORY-NNNN.N.N)  # User story (days)
          â””â”€â”€ Task (TASK-NNNN.N.N.N) # Technical task (hours)

  Bug (BUG-NNNN)                  # Independent of hierarchy
  ```

  ## ID Format and Examples

  | Type | Format | Example | File Path |
  |------|--------|---------|-----------|
  | Initiative | INIT-{NNNN} | INIT-0001 | INIT-0001/README.md |
  | Epic | EPIC-{NNNN}.{E} | EPIC-0001.2 | INIT-0001/EPIC-0001.2/README.md |
  | Story | STORY-{NNNN}.{E}.{S} | STORY-0001.2.3 | INIT-0001/EPIC-0001.2/STORY-0001.2.3/README.md |
  | Task | TASK-{NNNN}.{E}.{S}.{T} | TASK-0001.2.3.4 | INIT-0001/EPIC-0001.2/STORY-0001.2.3/TASK-0001.2.3.4.md |

  Where:
  - {NNNN} = Initiative number (4-digit zero-padded)
  - {E} = Epic number (no padding)
  - {S} = Story number (no padding)
  - {T} = Task number (no padding)

  ## Story Points and Estimation

  GitStory uses Fibonacci story points for estimation:

  | Points | Time | Example |
  |--------|------|---------|
  | 1 | <1 hour | Fix typo, update config |
  | 2 | 1-2 hours | Simple validation |
  | 3 | 2-4 hours | Basic feature |
  | 5 | 1 day | Standard feature |
  | 8 | 2-3 days | Complex feature |
  | 13 | 1 week | Major feature |

  **Task Estimation:**
  - Tasks estimated in hours (2-8 hours max)
  - Total task hours â‰ˆ story points Ã— 4 (Â±2h variance)

  ## BDD/TDD Integration

  **Every story follows incremental BDD pattern:**

  | Task | Focus | BDD Progress | Pattern |
  |------|-------|--------------|---------|
  | TASK-1 | Write ALL BDD scenarios | 0/N failing | Define behavior |
  | TASK-2 | Protocols/models + tests | 1-2/N passing | Foundation |
  | TASK-3 | Core impl (TDD) + BDD | 5-8/N passing | Build incrementally |
  | TASK-4 | Integration + final BDD | N/N passing âœ… | Complete |

  **Key Principles:**
  - BDD First (Task 1): All scenarios defined upfront, all failing
  - TDD Within Tasks: Unit tests written BEFORE implementation
  - BDD Incremental: Each task implements relevant BDD steps
  - No separate test tasks: Tests integrated throughout

  ## Status Tracking

  | Status | Symbol | Description |
  |--------|--------|-------------|
  | Not Started | ðŸ”µ | Planned but not begun |
  | In Progress | ðŸŸ¡ | Active development |
  | Complete | ðŸŸ¢ | Done and verified |
  | Blocked | ðŸ”´ | Waiting on dependency |

  ## Planning Commands

  **Create tickets:**
  - `/gitstory:plan-initiative [--genesis]` - Create initiative or define epics
  - `/gitstory:plan-epic EPIC-ID` - Define stories for an epic
  - `/gitstory:plan-story STORY-ID` - Define tasks for a story

  **Quality & review:**
  - `/gitstory:review-ticket TICKET-ID` - Quality review at any level
  - `/gitstory:analyze-gaps TICKET-ID` - Analyze gaps without changes
  - `/gitstory:start-next-task STORY-ID` - Start next pending task

  ## Directory Structure

  ```
  docs/tickets/
  â”œâ”€â”€ INIT-0001/              # Initiative
  â”‚   â”œâ”€â”€ README.md
  â”‚   â””â”€â”€ EPIC-0001.1/        # Epic
  â”‚       â”œâ”€â”€ README.md
  â”‚       â””â”€â”€ STORY-0001.1.1/ # Story
  â”‚           â”œâ”€â”€ README.md
  â”‚           â””â”€â”€ TASK-0001.1.1.1.md  # Task
  ```

  ## Quality Thresholds

  **Progressive quality requirements:**
  - Epics: 70% minimum (high-level scope)
  - Stories: 85% minimum (detailed requirements)
  - Tasks: 95% minimum (implementation-ready)

  ## References

  - Full ticket workflow: {baseDir}/../../docs/tickets/CLAUDE.md
  - Planning interview guide: {baseDir}/../../docs/PLANNING_INTERVIEW_GUIDE.md
  - Root workflow guide: {baseDir}/../../CLAUDE.md
  ```
- [ ] Validate word count â‰¥500 words
- [ ] Validate all {baseDir} links resolve

### Write template-authoring.md

- [ ] Create `skills/gitstory/references/template-authoring.md`:
  ```markdown
  # Template Authoring Guide

  **GitStory templates define ticket structure using YAML frontmatter and markdown content.**

  ## Template Structure

  Templates use YAML frontmatter (between `---` delimiters) to define fields:

  ```markdown
  ---
  name: "Story Template"
  description: "Template for user stories"
  version: "1.0.0"
  fields:
    - name: "story_points"
      type: "number"
      required: true
      validation: "1,2,3,5,8,13"
    - name: "acceptance_criteria"
      type: "list"
      required: true
  ---

  # STORY-{ticket_id}: {title}

  **Parent Epic**: [{parent_id}]({parent_path})
  **Status**: {status}
  **Story Points**: {story_points}

  ## Acceptance Criteria

  {acceptance_criteria}
  ```

  ## Field Types

  | Type | Description | Example |
  |------|-------------|---------|
  | text | Single-line text | "Project name" |
  | textarea | Multi-line text | "User story description" |
  | number | Numeric value | 5 (story points) |
  | list | Multiple items | ["Criterion 1", "Criterion 2"] |
  | boolean | Yes/No flag | true |
  | select | Dropdown choice | "ðŸ”µ Not Started" |

  ## Field Validation

  **Validation patterns:**
  ```yaml
  validation: "1,2,3,5,8,13"     # Allowed values
  validation: "min:1,max:100"    # Numeric range
  validation: "regex:^[A-Z]"     # Pattern match
  ```

  ## Variable Substitution

  **Variables available in templates:**
  - `{ticket_id}` - Current ticket ID
  - `{title}` - Ticket title
  - `{parent_id}` - Parent ticket ID
  - `{parent_path}` - Path to parent README
  - `{status}` - Status emoji (ðŸ”µðŸŸ¡ðŸŸ¢ðŸ”´)
  - Field values: `{field_name}` for any defined field

  ## Template Lookup Priority

  **3-tier lookup cascade:**
  1. Project override: `.gitstory/templates/story.md`
  2. User override: `~/.claude/skills/gitstory/templates/story.md`
  3. Skill default: `{baseDir}/templates/story.md`

  ## Example: Custom Bug Template

  ```markdown
  ---
  name: "Bug Template"
  description: "Template for bug reports"
  version: "1.0.0"
  fields:
    - name: "severity"
      type: "select"
      required: true
      validation: "ðŸ”´ Critical,ðŸŸ¡ High,ðŸŸ¢ Low"
    - name: "reproduction_steps"
      type: "list"
      required: true
    - name: "environment"
      type: "text"
      required: true
  ---

  # BUG-{ticket_id}: {title}

  **Severity**: {severity}
  **Status**: {status}
  **Environment**: {environment}

  ## Reproduction Steps

  {reproduction_steps}

  ## Expected vs Actual

  **Expected**: [Describe expected behavior]
  **Actual**: [Describe what happened]
  ```

  ## Example: Custom Epic Template

  ```markdown
  ---
  name: "Epic Template"
  description: "Template for epics with timeline tracking"
  version: "1.0.0"
  fields:
    - name: "story_points"
      type: "number"
      required: true
      validation: "min:8,max:55"
    - name: "timeline"
      type: "text"
      required: true
    - name: "child_stories"
      type: "list"
      required: false
  ---

  # EPIC-{ticket_id}: {title}

  **Parent Initiative**: [{parent_id}]({parent_path})
  **Timeline**: {timeline}
  **Story Points**: {story_points}
  **Status**: {status}

  ## Child Stories

  {child_stories}

  ## Overview

  [Epic description here]
  ```

  ## Best Practices

  1. **Keep fields focused** - Only include necessary fields
  2. **Use validation** - Enforce constraints at template level
  3. **Provide defaults** - Set sensible default values
  4. **Document structure** - Include comments explaining field purposes
  5. **Test with real data** - Validate template with actual ticket creation

  ## References

  - Default templates: {baseDir}/templates/
  - Template system story: {baseDir}/../../docs/tickets/INIT-0001/EPIC-0001.1/STORY-0001.1.3/README.md
  ```
- [ ] Validate word count â‰¥400 words
- [ ] Validate 3+ complete examples included
- [ ] Validate all YAML blocks parse correctly

### Write command-authoring.md

- [ ] Create `skills/gitstory/references/command-authoring.md`:
  ```markdown
  # Command Authoring Guide

  **GitStory commands define custom workflows with triggers, variables, and sequential steps.**

  ## Command Structure

  Commands use YAML configuration files:

  ```yaml
  name: "Plan Story"
  description: "Define tasks for a story with incremental BDD tracking"
  version: "1.0.0"

  triggers:
    - type: "pattern"
      value: "^/gitstory:plan\\s+STORY-\\d{4}\\.\\d+\\.\\d+$"
      description: "/gitstory:plan STORY-0001.1.2"
    - type: "keyword"
      value: "plan story"
      case_insensitive: true

  variables:
    - name: "ticket_id"
      source: "trigger_match"
      pattern: "STORY-\\d{4}\\.\\d+\\.\\d+"
    - name: "branch_name"
      source: "git"
      command: "git rev-parse --abbrev-ref HEAD"

  steps:
    - action: "extract_ticket"
      input: "{ticket_id}"
      description: "Load ticket file"
      output: "ticket_content"

    - action: "load_template"
      input: "story"
      description: "Load story template"
      output: "template_content"

  response_template: |
    Created tasks for {ticket_id}:
    {task_definitions}
  ```

  ## Trigger Types

  **Pattern Triggers (Regex):**
  ```yaml
  - type: "pattern"
    value: "^/gitstory:([a-z-]+)\\s+(\\w+-\\d+(\\.\\d+)*)$"
    description: "Matches /gitstory:command TICKET-ID"
  ```

  **Keyword Triggers (Literals):**
  ```yaml
  - type: "keyword"
    value: "create ticket"
    case_insensitive: true
    description: "Matches 'create ticket' anywhere in message"
  ```

  **Ticket ID Triggers (Glob patterns):**
  ```yaml
  - type: "ticket_id"
    value: "STORY-*"
    description: "Matches any story ticket ID"
  ```

  ## Variable Sources

  | Source | Description | Example |
  |--------|-------------|---------|
  | trigger_match | Extracted from trigger | ticket_id from pattern |
  | git | Git command output | current branch name |
  | conversation | User input from message | text after trigger |
  | git_command | Git command in step | output from git log |
  | template | Template field value | story_points field |

  ## Variable Substitution

  **Use `{variable_name}` syntax in steps:**

  ```yaml
  variables:
    - name: "ticket_id"
      source: "trigger_match"
    - name: "branch_name"
      source: "git"
      command: "git rev-parse --abbrev-ref HEAD"

  steps:
    - action: "update_ticket"
      input: "{ticket_id}, {branch_name}"
      description: "Update with current branch"
  ```

  ## Command Lookup Priority

  **3-tier cascade:**
  1. Project override: `.gitstory/commands/plan.yaml`
  2. User override: `~/.claude/skills/gitstory/commands/plan.yaml`
  3. Skill default: `{baseDir}/commands/plan.yaml`

  ## Example: Review Command

  ```yaml
  name: "Review Story Quality"
  description: "Validate story specification and score quality"
  version: "1.0.0"

  triggers:
    - type: "pattern"
      value: "^/gitstory:review\\s+(STORY|EPIC|INIT)-\\d{4}"
      description: "/gitstory:review STORY-0001.1.2"

  variables:
    - name: "ticket_id"
      source: "trigger_match"
    - name: "quality_score"
      source: "git_command"

  steps:
    - action: "validate_specification"
      input: "{ticket_id}"
      description: "Check for vague terms"
      output: "validation_report"

    - action: "score_quality"
      input: "{validation_report}"
      description: "Calculate 0-100% score"
      output: "quality_score"

  response_template: |
    Quality Score: {quality_score}%

    Issues Found:
    {validation_report}
  ```

  ## Example: Install Command

  ```yaml
  name: "Install GitStory"
  description: "Configure GitStory skill for project"
  version: "1.0.0"

  triggers:
    - type: "pattern"
      value: "^/gitstory:install"
    - type: "keyword"
      value: "install gitstory"
      case_insensitive: true

  variables:
    - name: "installation_path"
      source: "git"
      command: "pwd"
    - name: "os_type"
      source: "git"
      command: "uname -s"

  steps:
    - action: "create_directories"
      input: "{installation_path}/.gitstory"
      description: "Create .gitstory/ directory"
      output: "directories_created"

    - action: "configure_overrides"
      input: "{installation_path}/.gitstory/templates/"
      description: "Set up template overrides"
      output: "config_status"

  response_template: |
    GitStory installed at: {installation_path}
    OS: {os_type}
    Status: {config_status}
  ```

  ## Step Actions

  **Common action types:**
  - `extract_ticket` - Load ticket from docs/tickets/
  - `load_template` - Load template file
  - `interview_user` - Gather user requirements
  - `generate_tasks` - Create task breakdown
  - `update_ticket` - Modify ticket README
  - `validate_specification` - Check ticket quality
  - `score_quality` - Calculate quality percentage

  ## Best Practices

  1. **Keep triggers specific** - Avoid broad pattern matches
  2. **Validate inputs early** - Check ticket IDs in first step
  3. **Use meaningful variable names** - Clear intent
  4. **Document step purposes** - Explain each action
  5. **Test with edge cases** - Missing files, invalid IDs

  ## References

  - Default commands: {baseDir}/commands/
  - Command system story: {baseDir}/../../docs/tickets/INIT-0001/EPIC-0001.1/STORY-0001.1.4/README.md
  ```
- [ ] Validate word count â‰¥400 words
- [ ] Validate 3+ complete examples included
- [ ] Validate all YAML blocks parse correctly

### BDD Implementation (Scenarios 2, 3, 4, 8 partial)

- [ ] Implement step: "Given skills/gitstory/references/workflow-schema.md"
- [ ] Implement step: "When I read the workflow schema documentation"
- [ ] Implement step: "Then it explains 4-tier ticket hierarchy (INITâ†’EPICâ†’STORYâ†’TASK)"
- [ ] Implement step: "And workflow-schema.md is â‰¥500 words"
- [ ] Implement step: "Given skills/gitstory/references/template-authoring.md"
- [ ] Implement step: "When I review template authoring guide"
- [ ] Implement step: "Then it documents 6 field types with validation patterns"
- [ ] Implement step: "And template-authoring.md includes 3+ complete template examples"
- [ ] Implement step: "Given skills/gitstory/references/command-authoring.md"
- [ ] Implement step: "When I review command authoring guide"
- [ ] Implement step: "Then it documents 3 trigger types (pattern, keyword, ticket_id)"
- [ ] Implement step: "And command-authoring.md includes 3+ complete command examples"
- [ ] Implement step: "Given documentation with YAML and markdown examples"
- [ ] Implement step: "When validating example syntax"
- [ ] Implement step: "Then all YAML code blocks parse without errors"
- [ ] Implement step: "And all markdown renders correctly"
- [ ] Run BDD tests - Scenarios 1-4, 7, 8 pass (6/8 passing) âœ“

### Verification

- [ ] All 3 documentation files created
- [ ] Word count requirements met (workflow â‰¥500, others â‰¥400)
- [ ] All YAML examples parse correctly
- [ ] All markdown renders correctly
- [ ] Cross-references use {baseDir} correctly
- [ ] BDD Scenarios 2-4, 8 (partial) passing (6/8 total)

## Files to Create/Modify

- CREATE: `skills/gitstory/references/workflow-schema.md` (~700 words, ticket hierarchy)
- CREATE: `skills/gitstory/references/template-authoring.md` (~600 words, 3+ examples)
- CREATE: `skills/gitstory/references/command-authoring.md` (~600 words, 3+ examples)
- MODIFY: `tests/e2e/steps/test_documentation.py` (implement steps for Scenarios 2, 3, 4, 8 partial)

## Pattern Reuse

- `YAML configuration examples` (from STORY-0001.1.3, STORY-0001.1.4) - Reuse template and command YAML structures
- `Markdown documentation structure` (from docs/tickets/CLAUDE.md) - Follow established doc patterns

## Dependencies

- TASK-0001.1.5.2 complete (directory structure + validation framework)
- STORY-0001.1.3 complete (template system for examples)
- STORY-0001.1.4 complete (command system for examples)

## Edge Cases Handled

- Missing {baseDir} substitution (validator catches)
- Invalid YAML in examples (validator catches before commit)
- Broken cross-references (validator detects)
- Word count validation (automated check)

## Success Criteria

- [ ] All 3 core documentation files created
- [ ] Word count requirements met
- [ ] 3+ examples in each guide (template, command)
- [ ] All examples validate syntactically
- [ ] BDD Scenarios 2-4, 8 (partial) passing (6/8)
