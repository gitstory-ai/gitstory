# TASK-0001.1.3.1: Write BDD scenarios for template system

**Parent Story**: [STORY-0001.1.3](README.md)
**Status**: ðŸ”µ Not Started
**Estimated Hours**: 3
**Actual Hours**: -

## Objective

Write complete BDD test suite with all 6 scenarios from the story README in Gherkin format and stubbed step definitions. This task defines WHAT the template system should do before implementing HOW it does it.

## BDD Progress

**Before this task**: 0/6 scenarios (none exist)
**After this task**: 0/6 scenarios passing (all stubbed, all failing)

**Scenarios for this task:**

- Scenario 1: Default templates available in skills/gitstory/templates/
- Scenario 2: Template includes YAML frontmatter with field schemas
- Scenario 3: Template field validation follows JSON Schema patterns
- Scenario 4: Template lookup priority is: project â†’ user â†’ skill
- Scenario 5: Markdown body scaffold matches ticket conventions
- Scenario 6: Templates validate with Python YAML parser

## Implementation Checklist

### Create Feature File

- [ ] Create `tests/e2e/features/templates.feature`
- [ ] Write Scenario 1: Default templates available
  - [ ] Given the GitStory skill directory structure
  - [ ] When I check skills/gitstory/templates/
  - [ ] Then all 6 templates exist (init.md, epic.md, story.md, task.md, bug.md, custom.md)
- [ ] Write Scenario 2: YAML frontmatter with field schemas
  - [ ] Given skills/gitstory/templates/story.md
  - [ ] When I parse the YAML frontmatter
  - [ ] Then it includes name, description, fields array with >=3 definitions
  - [ ] And field types include: enum, string, number, boolean, array
- [ ] Write Scenario 3: Field validation patterns
  - [ ] Given all 6 templates with YAML frontmatter
  - [ ] When I validate field definitions
  - [ ] Then string fields include minLength/maxLength
  - [ ] And ticket ID fields validate with regex: ^[A-Z]+-\d{4}(\.\d+)*$
- [ ] Write Scenario 4: Template lookup priority
  - [ ] Given project/user/skill template locations
  - [ ] When loading a story template
  - [ ] Then project override checked first, user second, skill fallback
- [ ] Write Scenario 5: Markdown scaffold structure
  - [ ] Given skills/gitstory/templates/task.md
  - [ ] When I review the markdown body
  - [ ] Then it includes proper heading levels (H1 title, H2 sections, H3 subsections)
- [ ] Write Scenario 6: YAML parser validation
  - [ ] Given all 6 templates
  - [ ] When I parse each with yaml.safe_load()
  - [ ] Then no parsing errors occur

### Create Step Definition Stubs

- [ ] Create `tests/e2e/steps/test_templates.py`
- [ ] Stub all step definitions (each raises NotImplementedError)
- [ ] Ensure clear step names matching Gherkin
- [ ] Group steps by scenario for clarity

### Verification

- [ ] Run pytest - all 6 scenarios fail with NotImplementedError âœ“
- [ ] Scenarios are concrete and executable (no vague terms)
- [ ] Step definitions follow pytest-bdd decorator naming conventions

## Files to Create/Modify

- CREATE: `tests/e2e/features/templates.feature` (~120 lines, 6 scenarios)
- CREATE: `tests/e2e/steps/test_templates.py` (~80 lines, stubbed steps)

## Pattern Reuse

- `pytest-bdd feature file organization` (tests/e2e/features/*.feature) - Separate Gherkin scenarios from step implementations for clarity

## Dependencies

- Feature file format follows pytest-bdd Gherkin syntax
- Step definitions use pytest-bdd decorators (@given, @when, @then)
- Scenarios match story README exactly (copy verbatim)
